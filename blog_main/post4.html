
<!DOCTYPE HTML>
<html>

<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<head>
<title>CrazyLazyLife - Blog</title>
<link href="css/bootstrap.css" rel='stylesheet' type='text/css' />
<link href="css/style.css" rel='stylesheet' type='text/css' />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="face detection siamese network one shot learning trpliet loss function" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<link href='http://fonts.googleapis.com/css?family=Oswald:100,400,300,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,300italic' rel='stylesheet' type='text/css'>
<script src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/move-top.js"></script>
<script type="text/javascript" src="js/easing.js"></script>

<script type="text/javascript">
			jQuery(document).ready(function($) {
				$(".scroll").click(function(event){
					event.preventDefault();
					$('html,body').animate({scrollTop:$(this.hash).offset().top},900);
				});
			});
</script>

</head>
<body>
<script src='../../../../ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script><script src="../../../../m.servedby-buysellads.com/monetization.js" type="text/javascript"></script>
<script>
(function(){
	if(typeof _bsa !== 'undefined' && _bsa) {
  		_bsa.init('flexbar', 'CKYI627U', 'placement:w3layoutscom');
  	}
})();
</script>
<script>
(function(){
if(typeof _bsa !== 'undefined' && _bsa) {
	_bsa.init('fancybar', 'CKYDL2JN', 'placement:demo');
}
})();
</script>
<script>
(function(){
	if(typeof _bsa !== 'undefined' && _bsa) {
  		_bsa.init('stickybox', 'CKYI653J', 'placement:w3layoutscom');
  	}
})();
</script>
<body>

<div class="header">
	 <div class="container">
		  <div class="logo">
			  <a href="blog_index.html"><img src="images/logo.jpg" title="" /></a>
		  </div>

			 <div class="top-menu">
				 <div class="search">
					 <form>
					 <input type="text" placeholder="" required="">
					 <input type="submit" value="">
					 </form>
				 </div>
				  <span class="menu"> </span>
				   <ul>
						<li class="active"><a href="blog_index.html">HOME</a></li>
						<li><a href="../index.html">MAIN</a></li>
						<div class="clearfix"> </div>
				 </ul>
			 </div>
			 <div class="clearfix"></div>
					<script>
					$("span.menu").click(function(){
					$(".top-menu ul").slideToggle("slow" , function(){
					});
					});
					</script>

	 </div>
</div>

<div class="single">
	 <div class="container">
		  <div class="col-md-8 single-main">
			  <div class="single-grid">
					<img src="https://img.itw01.com/images/2018/06/18/04/0749_qghvfj_2GMQGEO.png" alt=""/>
		<div class="main_body">			<p>
      Hello Coders,
<br>
With the world of programmers and scientists going crazy over artificial intelligence, it’s becoming a need of the hour to stay updated on the various research on deep learning that is helping in faster growth of AI. This post is about one of the deep learning model successfully applied in the image recognition industry, over the years. This one will not include the code for implementation or any of the mathematical stuff but will cover only the basics. its advisable to have a basic idea about the working of a Simple Neural Network.
<br>
In 1995, <strong>Yann LeCun</strong> and <strong>Yoshua Bengio</strong> introduced the concept of Convolutional Neural Networks.
<br><br>
As a sort of formal definition, “<strong>Convolutional neural networks </strong>or <strong>CNN</strong>s, are a specialized kind of neural network for processing data that has a known, grid-like topology. Examples include time-series data, which can be thought of as a 1D grid taking samples at regular time intervals, and image data, which can be thought of as a 2D grid of pixels. Convolutional networks have been tremendously successful in practical applications. The name “convolutional neural network” indicates that the network employs a mathematical operation called <strong>convolution</strong>. Convolution is a specialized kind of linear operation............. <em>Blah Blah!!!</em>” Was too much to take in at once, but, believe me, it will get easy as it goes in the details.
<br>
<strong>CNN</strong>s are very <strong>similar to ordinary Neural Networks</strong> - they are made up of neurons that have learnable weights and biases. Each neuron receives some inputs, performs a dot product and optionally follows it with a non-linearity. Now for those who have a general idea on how the neural network works, it will be easy to visualize. For the others who don’t know anything about Simple Neural Network, it will be better if you could at least read about the basic working from some resource.
<br><br>
<span style="text-decoration: underline; font-size: 25px; color: black;">Background:</span>

<br>So, what exactly led to the idea for its development? <strong>CNNs</strong> are biologically-inspired models inspired by research of <strong>D. H. Hubel</strong> and <strong>T. N. Wiesel</strong>. They proposed an explanation for the way in which mammals visually perceive the world around them using a layered architecture of neurons in the brain, and this in turn inspired engineers to attempt to develop similar pattern recognition mechanisms in computer vision.
<br>
In their hypothesis, within the visual cortex, complex functional responses generated by "complex cells" are constructed from more simplistic responses from "simple cells'. For instances, simple cells would respond to oriented edges etc, while complex cells will also respond to oriented edges but with a degree of spatial invariances.
<br>
<img src="http://file.elecfans.com/web1/M00/52/2C/o4YBAFsRB6CARCTMAABGxHkR1Tc177.jpg" alt="human_vision" width="638" height="203" />
<br>
Receptive fields exist for cells, where a cell responds to a summation of inputs from other local cells. The architecture of deep convolutional neural networks was inspired by the ideas mentioned above
<br><span style = "padding-left: 25px;">1. <strong>local connections</strong></span>
<br><span style = "padding-left: 25px;">2. <strong>layering</strong></span>
<br><span style = "padding-left: 25px;">3. <strong>spatial invariance</strong> (shifting the input signal) results in an equally shifted output signal, most of us can recognize specific faces under a variety of conditions because we learn abstraction. These abstractions are thus invariant to size, contrast, rotation, orientation</span>
<br>
As an example, let’s consider a car. How does a human recognize that it is a car? We basically search for the characteristics that are unique to a car. We look for wheels, head-lights, doors, rear trunk, glass windows, hood and other features that differ it from other modes of transport. Similarly, while recognizing a wheel, we look for circular-shaped objects, comparatively dark colored with a rough texture, positioned below the main structure of the car. We take into account all the little details that together constitute to form some basic information. These small informations together bunch up to form a particular characteristic that is unique to an object that we are recognizing.
<br>
<br><span style="text-decoration: underline; font-size: 25px; color: black;">Layout of the Components:</span>
<br><img src="https://cdn-images-1.medium.com/max/1600/0*8FyySlsfLgOp9WTc." alt="how2" width="1255" height="424" />
<br>
“<em>A simple CNN is a sequence of layers, and every layer of a CNN transforms one volume of activations to another through a differentiable function</em>.” What it actually means is that, each layer is associated with converting the information from the values, available in the previous layers, into some more complex information and pass on to the next layers for further generalization.
<br>
<strong>The CNN is a combination of <u>two basic building blocks</u>:</strong>
<br>
<br><span style = "padding-left: 25px;">1. <strong>The Convolution Block </strong>– Consists of the Convolution Layer and the Pooling Layer. This layer forms the essential component of <em>Feature-Extraction.</em></span>

<br>
<br><span style = "padding-left: 25px;">2. <strong>The Fully Connected Block </strong>– Consists of a fully connected simple neural network architecture. This layer performs the task of <em>Classification</em> based on the input from the convolutional block.</span>

<br>We shall define each of these layers now. People who have a little knowledge of image processing might find it easy to grasp, however others can find it easy too.
<br><br><span style="text-decoration: underline; font-size: 25px; color: black;">Defining the Layers:</span>
<br>We shall describe the working theory of each of the layers.
<br><br><span style="text-decoration: underline; font-size: 20px; color: black;">CONVOLUTIONAL LAYER:</span>
<br>The <strong>CONVOLUTIONAL LAYER is related to feature extraction</strong>. First let us get clear of the idea of ‘<em>filters</em>’ and ‘<em>convolution</em>’, then, we shall move on to its implementation in the layer.
<br>
<strong>Filters: </strong>Filters or ‘kernels’ are also an image that depict a particular feature. For example, let us take the picture of this curve. We take this as a sample feature that we will try to recognize, i.e., determine whether it is present in an image.
<br>
<img src="https://blog.bkbklim.com/wp-content/uploads/2017/11/filter1.png" alt="filter_visualization" width="3360" height="400" />
<br>
<strong>Convolution: </strong>It is a special operation applied on a particular matrix (, usually the image matrix) using another matrix (, usually the filter-matrix). The operation involves <strong>multiplying the values of a cell corresponding to a particular row and column, of the image matrix, with the value of the corresponding cell in the filter matrix. We do this for the values of all the cells within the span of the filter matrix and add them together to form an output.</strong>
<br>
For example, A (part of the image matrix) = [ 2 5 17 ] and B (part of the filter matrix) = [ 1 0 1 ]. Then the answer of A *(convolve) B = [ 2*1 + 5*0 + 17*1 ] = [ 2 + 17 ] = [ 19 ]. This is just an example. In practice both of the matrix are 2-D, but the sense of the operation remains the same.
<br>
This will explain the operation nicely. You can see, how the filter-matrix spans over the whole matrix, performing the operation at each step and generating the desired output-matrix:
<br>
<img src="https://cdn-images-1.medium.com/max/1600/1*ZCjPUFrB6eHPRi4eyP6aaA.gif" alt="convolutin" width="458" height="334" />
So, now, how do we find a particular feature? We simply convolve the ‘filter-matrix’ over the image matrix and constitute another matrix that contain some values. Now, what are these values? Let’s get back to our filter image, we considered before and take the image of a simple mouse.
<br>
<br>
<img src="http://3.bp.blogspot.com/-4hQ7nXjc85s/Wh0p92U0rHI/AAAAAAAABuI/IHrnc83Jen0CG-E43ZbKCvUshD2usfd7ACK4BGAYYCw/s1600/tpQvMps%255B1%255D.jpg" alt="filter_use1" width="3360" height="400" /><em>Image 1</em>:<br>
<img src="https://blog.bkbklim.com/wp-content/uploads/2017/11/filter3.png" alt="filter_use2" width="3360" height="400" /><em>Image 2</em>:
<br>
Notice that the rear of the mouse is of a similar shape. So, we convolve the filter within that region of the image-matrix. We also consider another region of the image that does not possess the same curve-like feature. We also perform the operation on that section of the image using the same filter-matrix. Now, take a look at the values of the corresponding operation. <strong>(Do not get confused at the matrix representation of the filer image and that, depicting a part of the mouse image.)</strong>
<br>
<br>
Image1 depicts a very large value, while Image2 results to 0. Thus, <strong>the basic intuition to be taken from here, is that, if the feature is present in a particular part of the image, it returns a very large value on convolution, while for the other places, it would return a small value, depicting that the feature is not present.</strong>
Now, that we have a clear idea of both, we shall apply them in feature extraction. We have as our input say a colored image, i.e. a 2-D RGB image matrix. We also have  no. of filter-matrix, which are 2-D matrix depicting some characteristics. So<strong>, we take each filter-matrix, convolve it over the corresponding part of the image-matrix of all the red, green and blue channel-matrices and add the values form each channel together to form the value of cell of the output-matrix</strong>.
<br>
<br>
In doing so, we are essentially trying to find out whether a particular feature is present in the image we are trying to recognize. Now, there are a few other operations required to be performed on the image during convolution.
<br>
<br>1.<strong>Padding:</strong> If we try to visualize the operation of convolution, in our head, as the filter matrix moves over the whole image, we find that the no of times, the values of the cells lying within the matrix is considered for the operation is more than the no. of times, the values of the cells in the corners or at the borders, are accounted for. This implies that the values at the corners or around the borders are not being given equal weightage. To overcome this, we add another row and column, of only 0, at all the sides of the image matrix. This idea is known as padding. In actual sense, these values being ‘0’ wouldn’t supply any extra information, but will help into accounting the previously less-accounted for values to be given more weightage.

<br><img src="https://ask.qcloudimg.com/http-save/yehe-1000059/kg8orcp9sd.png?imageView2/2/w/1620" alt="padd" width=150 height="198" />
2.<strong> Striding: </strong>In ‘strided’ convolution, instead of shifting the filter one-row or one-column at a time, we shift it, maybe, 2 or 3 rows or columns, each time. This is generally done to reduce the no of calculation and also reduce the size of the output matrix. For large image, this doesn’t results in loss of data, but reduces computation cost on a large scale.
<br><img src="http://deeplearning.net/software/theano/_images/padding_strides_odd.gif" alt="conv_stride" width="291" height="281" />
<br>
<br>3. <strong>RELU Activation: </strong><em>RELU or Rectified Linear Unit</em> is applied on all the cells of all the output-matrix. The function is defined as:
<br><img src="https://cdn-images-1.medium.com/max/1600/1*JtJaS_wPTCshSvAFlCu_Wg.png" alt="conv_stride" width="291" height="281" /><br>
The basic intuition to derive from here is that, after convolution, if a particular convolution function results in ‘0’ or a negative value, it implies that the feature is not present there and we denote it by ‘0’, and for all the other cases we keep the value.
<br>
Together with all the operations and the functions applied on the input image, we form the first part of the Convolutional Block.
<br>
<br><span style="text-decoration: underline; font-size: 25px; color: black;">POOLING LAYER:</span>
<br>
The Pooling layer consist of performing the process of extracting a particular value from a set of values, usually the max value or the average value of all the values. This reduces the size of the output matrix. For example, for MAX-POOLING, <strong>we take in the max value among all the values of say a 2 X 2 part of the matrix. Thus, we are actually taking in the values denoting the presence of a feature in that section of the image</strong>. <strong>In this way we are getting rid of unwanted information regarding the presence of a feature in a particular portion of the image and considering only what is required to know</strong>. It is common to periodically insert a Pooling layer in-between successive convolutional blocks in a CNN architecture. Its function is to progressively reduce the spatial size of the representation to reduce the number of parameters and computation in the network.
<br>
<img src="https://cdn-images-1.medium.com/max/1200/1*KQIEqhxzICU7thjaQBfPBQ.png" alt="pooling" width="437" height="311" />
<br>
Together with the <strong>CONVOLUTIONAL LAYER </strong>and the <strong>POOLING LAYER</strong>, we form the <strong>CONVOLUTINAL BLOCK</strong> of the CNN architecture. Generally, a simple CNN architecture constitutes of a minimum of three of these Convolutional Block, that performs feature extraction at various levels.
<br><br>
<span style="text-decoration: underline; font-size: 25px; color: black;"><strong><u>FULLY CONNECTED LAYER:</u></strong></span>
This layer forms the last block of the CNN architecture, related to the task of classification. This is essentially a Fully connected Simple Neural Network, consisting of two or three hidden layers and an output layer generally implemented using ‘<a href="http://ufldl.stanford.edu/tutorial/supervised/SoftmaxRegression/">Softmax Regression</a>’, that performs the work of classification among a large no of categories. Hope you can understand the basic idea of the regression analysis from the link.
<br>
<br><span style="text-decoration: underline; font-size: 25px; color: black;"><strong><u>BRINGING EVRYTHING TOGETHER:</u></strong></span>
<br>
<br><img src="https://i1.wp.com/pic2.zhimg.com/v2-dda4fd29609e43ac0861d2cb843e260b_r.jpg" alt="cnn_1" width="2344" height="400" />
So, what happens from the beginning to the end of the CNN.
<br>
<br><span style = "padding-left: 25px;">1. We give input an RGB image. It is generally a 2-D matrix defined for the 3 color channels. Let each channel be of size n X n. Thus, the input is a n X n X 3 dimension matrix.</span>
<br><span style = "padding-left: 25px;">2. We have a 3-D matrix, consisting of (say) ‘k’ no. of filters of a size (say f X f).</span>
<br><span style = "padding-left: 25px;">3. We perform PADDING on the image of say ‘p’ rows & columns. Thus, the input-matrix becomes (n+2*p) X (n+2*p) X 3 dimensions.</span>
<br><span style = "padding-left: 25px;">4. Next, we perform the strided convolution operation of the filter-matrices on the input image-matrices, as described before, using a stride of say ‘s’. Thus, the output matrix becomes</span>
<br><span style = "padding-left: 25px;">5. We perform POOLING over the output-matrix of each layer. The dimension of the output-matrices depends of the size of the pooling-filter and the stride length we have defined.</span>
<br><span style = "padding-left: 25px;">6. We perform the same operatio from step 3 – 5, nearly three time.</span>
<br><span style = "padding-left: 25px;">7. On receiving the output-matrices of some dimension say a X b X <em>l</em>, we flatten the output into a 1-D array, i.e., we arrange all the values from the matrices sequentially in an array which forms the input matrix for the Fully – Connected Neural Network.</span>
<br><span style = "padding-left: 25px;">8. This neural network performs the desired calculation and gives the result.</span>
<br>
<br><span style="text-decoration: underline; font-size: 25px; color: black;"><strong><u>BACKPROPAGATION:</u></strong></span>
<br>So, a general question remains regarding defining the matrix for each filter. This is not predefined. The CNN is trained over a larger no of image during the training phase and for each time, the error generated is fed back into to CNN to adjust the values of the matrices in each layer. The basic working is similar to that of the training of a Simple Neural Network. The concept is <strong>BACKPROPAGATION. </strong>Since, this article deals with only the basics, I shall not delve into the mathematical background behind Backpropagation and the adjustment of values. May be, this topic can be covered in some other post.
<br>
<br><span style="text-decoration: underline; font-size: 25px; color: black;">WHAT WE SAW HAPPENING:</span>
<br>
<img src="https://what.thedailywtf.com/assets/uploads/files/1489363921147-deep_net_hierarchical_recognition.jpeg" alt="conv_net_arch" width="2000" height="400" />
<br><br>
<strong>This image is of the various features at each Convolutional Block of a fully trained CNN. The basic thing to understand from this image is that, the filters at various layers are adjusted to determine various features of the image. The filters at the beginnign captures some basic edges or blobs. The filters in the next layer considers various textures. The filters in the deeper layers are able to recognize various object parts that constitute an object. In the end, the Fully Connected Layer is trained to classify the image, based on the information gathered, into various object classes.</strong>
<br>
A CNN model can be thought as a combination of two components: feature extraction part and the classification part. The convolution + pooling layers perform feature extraction. For example, given an image, the convolution layer detects features such as two eyes, long ears, four legs, a short tail and so on. The fully connected layers then act as a classifier on top of these features and assign a probability for the input image being a dog.
<br>
<strong>The convolution layers are the main powerhouse of a CNN model</strong>. Automatically detecting meaningful features given only an image and a label is not an easy task. The convolution layers learn such complex features by building on top of each other. The first layers detect edges, the next layers combine them to detect shapes, to following layers merge this information to infer that this is a nose. To be clear, the CNN doesn’t know what a nose is. By seeing a lot of them in images, it learns to detect that as a feature. The fully connected layers learn how to use these features produced by convolutions in order to correctly classify the images.
<br><br><span style="text-decoration: underline; font-size: 25px; color: black;">WHY USE IT AT ALL:</span>
<br>
If you think carefully, for an color image of size 256 X 256 X 3( for each color channel), the size of the input layer of a simple neural network would be 196,608 neurons, each connected to a large no. of neurons in the hidden layers. This increases the size of the stored data and the overall computation cost. You can very well image the size of the matrix required to store the weights for the connections of each neuron of one layer to the neurons of the next layer. This implementation is infeasible compared to the capability of the computers used for day-to-day use.  Moreover, CNN works in close proximity to the idea of how humans <strong>"might"</strong> visualize and recognize objects. There is re-usability of the filters that helps us confirm the presence of features throughout the image. This is in contrast to the working of a Simple NN, that does nothing of these sort. The various operations like striding, pooling reduces the total no of parameters to be accounted for. This decrease is nearly a thousand times more effective in reducing the data space and computation cost of that of a Simple NN.
<br>
Hope that you have understood the basic concept behind its design. I hope to bring another article on some of the famous variations of CNN that are presently being used in various fields.
<br>
Live long and Code

			 <ul class="comment-list">
		  		   <h5 class="post-author_head">Written by <a href="#" title="Posts by admin" rel="author">@crazylazylife</a></h5>
		  		   <li><img src="images/avatar.png" class="img-responsive" alt="">
		  		   <div class="desc">
		  		   <p>View all posts by: <a href="#" title="Posts by admin" rel="author">crazylazylife</a></p>
		  		   </div>
		  		   <div class="clearfix"></div>
		  		   </li>
		  	  </ul>
			  <div class="content-form">
					 <h3>Leave a comment</h3>
					<form>
						<input type="text" placeholder="Name" required/>
						<input type="text" placeholder="Email" required/>
						<input type="text" placeholder="Phone" required/>
						<textarea placeholder="Message"></textarea>
						<input type="submit" value="SEND"/>
				   </form>
						 </div>
		  </div>
			  <div class="clearfix"></div>
		  </div>
	  </div>

<div class="footer">
	<div class="container">
		<p>CRAZYLAZYLIFE Personal Blog . All rights reserved </p>
	</div>
</div>
